---
title: Spatiotemporal behaviour of a male wild boar, sus scrofa, in the pre-Alps of the canton Fribourg.
subtitle: Projet for the course "Patterns and trends in environmental data"
author: Vanina Heinrich, heinrvan@students.zhaw.ch
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r}
#packages needed 
library(readr)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)
library(tmap)
library(sf)
library(terra)
library(gifski)
library(sp)
library(forcats)
library(gganimate)
```





## Abstract

In September 2019, a male wild boar was captured in the pre-Alps of
Fribourg. It was equipped with a GPS collar and its movements could be
followed for almost 2 whole years. The tracking of this wild boar was
analyzed according to 4 aspects: global analysis of its movements,
analysis of important points of presence, analysis of the use of the
land cover and finally analysis of its activity patterns. The results
show a great variability both in the territory occupied and in the use
of the different covers. Hunting shows an important influence on its
general activity. The results give a direction to future analyses that
will be carried out on other individuals in the pre-Alps in order to
confirm the elements found during this project.

No studies have been conducted on the movements of wild boar in the
Pre-Alps. These analyses are done in the framework of a pre-study. The
data are the property of the state of Fribourg and must be treated
confidentially.

## Introduction and research aims

Wild boars, sus scrofa, are common mammals in Europe. The study of their
movements and habits is used in particular within the framework of the
management of their populations but also for the prevention of damage
caused to agricultural crops. Many studies have been done to understand
the spatio-temporal behavior of wild boars but none has been published
on wild boars in the Pre-Alps. The pre-Alps present a particular
territory due to their steep nature and their landscape coverage.

In this study, the movements of a male wild boar located in the Fribourg
pre-Alps were analyzed over almost two years. The first goal of these
analyses was to define the animal's home range and its use of it, but
also to see if landscape aspects (altitude, land cover) influence its
use of space. The second goal was to analyze its habits and the effect
of an anthropogenic disturbance (hunting in this case) on its habits.

This study was done in part from a global analysis to a more detailed
analysis. Four elements guided the analysis with the following
questions: - The analysis of its general home range: where is the boar
located? What are the movements it has made and when? Are there
differences between seasons in its occupation of space? - Analysis of
areas of high density of presence: did the boar stay in certain places
for a long time or did it go back and forth? What is present in these
areas? - Analysis of surface cover: what is found in this boar's home
range? How did it use the surface cover? What is found in areas of high
density presence? - Analysis of its habits: when is it most active? Are
there differences in the use of ground cover? What is the impact of
hunting on his habits?

## Material and Methods

```{r}
#import the data

jojo <- read_delim("20220504_sanglier_SFN.csv", delim = ";", escape_double = FALSE, col_types = cols(Date = col_date(format = "%d.%m.%Y"), Time = col_time(format = "%H:%M:%S"), Altitude = col_number(), X = col_number(), Y = col_number()), trim_ws = TRUE)

#Some elevation points are upon 2000 which is impossible as the highest point in the region has an elevation of 2014m, therefore, all the points higher than 2000 were taken away. Same for points deeper than 600m

jojo <- jojo %>%  filter(Altitude > 600 & Altitude < 2000 )

ggplot(head(jojo)) + geom_point(mapping = aes(X, Y))
```

```{r}
knitr::opts_chunk$set(eval = FALSE)
```

### Data set

The data set used in this project comes from the Forest and Nature
Department of the canton of Fribourg. In September 2019, a male wild
boar was captured in the Fribourg pre-Alps and fitted with a GPS collar.
This collar transmitted the position of the animal every hour from 6pm
to 6am and then once at noon. The collar was programmed by the service
based on the literature mentioning that the wild boar is a nocturnal
animal. Location data could thus be obtained until July 2021. The animal
then suddenly disappeared and so did the GPS transmission.

The data set contains 9431 lines, each corresponding to a location
defined by X and Y coordinates according to the Swiss coordinate system
(LV95/LV03, crs = 2056). The base file contains the following columns:

-   Date: date of the survey
-   Time: time of the survey
-   Altitude: altitude of the GPS point
-   X: X coordinate
-   Y: Y coordinate

### Preprocessing

This data set required some additional columns derived from the base
file data to allow for further analysis to answer the questions outlined
in the introduction to this project.A first visual analysis of the file
in excel was done to observe the data.

The analysis of the "Altitude" column revealed values that could not
correspond to the region where the boar was located. Indeed, the highest
point in the region is at 2014m (Dent de Lys) and some location points
exceeded this value. These points were removed. The same was done for
the location points below 600m altitude.

**(map of the region)**

The dates were analyzed and a subclassification by months and years was
done. These data were added as new columns to the available data. Date
and time were also merged together in a new column.A "Daytime" column
has been added. This one is based on the "Timelag" column. If the time
difference is less than 65 minutes, it concerns measurements taken at
night (from 6pm to 6am), if this difference is greater than 360 minutes,
it concerns measurements taken during the day (between 6am and 6pm). The
column therefore contains the information Day or Night.

In order to calculate the activity pattern of this boar, I decided to
base my calculations on its speed. The speed is calculated by the
distance traveled in a certain time lapse. For that, a "Timelag" column
was created which indicates the time elapsed between two locations,
based on the "Datetime" column created during the previous manipulation
of the "Date" and "Time" data. Then, a "steplength" column was created.
This one indicates the distance between two rows, i.e. two location
points. Finally, a "Speed" column has been created. This one is the
result of the "Steplength" column divided by the "Timelag" column (Speed
= Steplength/Timelag).

Finally, to analyze the influence of hunting on the activity of this
boar, two new columns were created. The first one is the hunting
pressure which was evaluated according to the number of species hunted
at the same time on a given date. This information was provided by the
Forest and Nature Department of the Canton of Fribourg. Based on this
information, four categories were established for hunting pressure:

-   0 - no hunting

-   1 - only wild boar hunting

-   2 - hunting of wild boar + 1 other species

-   3 - wild boar hunting + 2 other species

An additional column was created to indicate whether or not hunting was
taking place, based on the hunting pressure (0 = no hunting, 1/2/3 =
hunting).

Some analyses could only be done with the year 2020, the only full year
of data. This is why a second data_frame was created with only the
points of 2020, subset of the original data frame.

### Methods 

I would like to point out that all of the methods described below can be
applied to other similar data sets. These same manipulations will be
used to study the movements of other wild boars in this same region in a
future study.

### Global analysis of the home range 

Wild boars are territorial. In order to understand the extent of the
male boar's territory in this study, a visual analysis of its presence
was performed. I performed a mcp derived from the location points of
this boar to identify its home range. For this purpose, the function
st_convex_hull has been applied. It takes a point cloud as input and
draws a convex hull around the most distant vertices. The area was then
calculated using the chull.area function and compared to the results
obtained on ArcGis Pro for validation. The home range was analysed for
all the data from 2019 to 2021

The altitude at which this boar was located is an important element
considering the region in which it is located. Therefore, a boxplot
analysis was performed to see the average elevation the boar was located
at as a function of the months in 2020.

### Density and path 

To visualize the areas where wild boar were most often (high density of
presence), an analysis via ArcGis Pro was performed by Kernel Density
approach. Following this result, and in order to understand if these
areas correspond to areas where the wild boar stayed for a long time or
if it came back all the time, an analysis of the path by ggplot with the
geom_path function was performed for each month in 2020.

### Land cover and use of it 

With the help of ArcGis Pro, a geopackage regrouping the data of the
departements of agriculture and forests of the canton of Fribourg for
the year 2020 has been created. This was then imported into R-studio. A
column was added with the translation in English of the different types
of surfaces for a better understanding. By analyzing the different types
of surfaces and thinking about the behavior that a wild boar could have
in them, I decided to create three surface overclasses: grassland areas
which includes meadows, pastures and other rather open surfaces, forests
and finally the surfaces corresponding to woodlands outside forests
(Hedges-, fields- and riverbank woods). To facilitate the analysis of
the data, I decided to work only with the main surface categories as
well as the surface classes I created. For elements requiring detail
such as a particular field, I worked with ArcGis Pro. The 2020 wild boar
data frame and the geopackage data were then combined into a single data
frame for further analysis.

A ggplot was made to visualize the presence of wild boar on the
different terrains.

To find out the exact use of surface types by wild boar, the percentage
of location points present in each surface type was calculated. This
manipulation was then refined to identify the type of surface used
according to the time of day and also according to the months.

### Activity patterns 

The speed of the boar was used as a basis for analyzing its activity
rate. The GPS collar was programmed to transmit its position once an
hour during the night from 6:00 p.m. to 6:00 a.m. and then once at noon,
based on the boar's nighttime activity. In order to verify this, two
subsets were created: one for the day and one for the night. The average
of the two subsets was calculated and then they were compared. For a
better visualization, a boxplot was made. A day/night comparison was
made by boxplot according to the months in 2020.

Finally, as speed can also depend on the type of surface on which the
boar moves, a boxplot analysis of the different speeds according to the
type of surface was performed.

### Effect of Hunting 

Thurfjell et al. demonstrated in 2013 that hunting had an influence on
boar movement speed. To understand the influence of hunting on this male
boar, a boxplot analysis of travel speeds by hunting pressure was
performed.

To analyze whether hunting also induced a change in the boar's surface
type use patterns, the percentage of location points in a surface type
as a function of whether hunting occurred was performed.

## Results

### Home range and vertical migration

This male boar was moving in the region of the Fribourg pre-Alps. Its
home range was limited by the freeway to the west and by the Sarine
river to the east. Its home range from 2019 to 2021 was 158.97 km2. 

**Figure x with mcp**

The analysis of the altitude at which the boar were located in 2020
shows that a vertical migration to higher altitudes took place in spring
until June. From July onwards, it can be observed that the boar again
descended to lower altitudes. For the rest of the year 2020, the boar
was located at approximately the same altitudes.

**Graph x elevation \~ month**

### Horizontal migration and land cover use

The point density analysis shows several areas of high density,
including one in the northwest near the highway **(see Figure x)**. The
point analysis of wild boar presence by month does not show that wild
boar remained for a long time (minimum one month) in the same area. Path
analysis by month confirms this trend, indicating that the boar was
moving back and forth within its home range.

**Figure X with density**

All the analyses carried out concerning the use of the different types
of surface show that the wild boar was mainly located in the forest. Its
presence in the forest did not vary much between months. Its presence in
summer pastures was more important in May, June and July 2020 than in
the other months. In January 2020, almost 30% of the wild boar were
located in areas not identified in the available geopackage compared to
10% in December 2020. 

**figure x with land cover per month detailled**

The wild boar were primarily located in the forest during the day
(between 6:00 am and 6:00 pm) and diversified the areas where they were
located at night.

**figure x land cover \~daytime per month**

### Activity patterns

The speed of the boar does not show a big visual difference from month
to month. It averages 0.64 m/min during the day (6am to 6pm) and 5.04
m/min at night (6pm to 6am).

The boar moved slower on average in the forest than in other surface
types.

**(Table)**

### Effect of hunting

## Discussion

Discussion discussion discussion discussion

These results were validated by personal visualization. A detailed
statistical analysis is necessary to be able to affirm if the trends
observed on the obtained graphs are significant or not. This analysis
will be carried out in a second time, outside the framework of this
work.

## R-Code




```{r}
#tidy up the dates

m <- ymd(jojo$Date)
Monthnb <- month(m)
y <- ymd(jojo$Date)
Year <- year(y)
jojo <- mutate(jojo, Monthnb, Year)
jojo <- mutate (jojo, Month = as.character(case_when(Monthnb == 1 ~ "January", Monthnb == 2 ~ "February", Monthnb == 3 ~ "March", Monthnb == 4 ~ "April", Monthnb == 5 ~ "May", Monthnb == 6 ~ "June", Monthnb == 7 ~ "July", Monthnb == 8 ~ "August", Monthnb == 9 ~ "September", Monthnb == 10 ~ "October", Monthnb == 11 ~ "November", Monthnb == 12 ~ "December")))
jojo <- mutate(jojo, Monthyear = paste(Month,Year))
jojo$DateTime = ymd_hms(paste(jojo$Date, jojo$Time))
jojo <- mutate(jojo, Month = fct_reorder(Month, Monthnb))
```

```{r}
#Calculate Timelag, steplength and speed

X2 <- lead(jojo$X, 1)
Y2 <- lead(jojo$Y, 1)
Steplength <- sqrt((jojo$X - X2)^2 + (jojo$Y - Y2)^2)
jojo <- mutate(jojo,Timelag = as.numeric(difftime(lead(DateTime),DateTime)), Steplength)
Speed <- jojo$Steplength/jojo$Timelag #speed is in meters/minutes
jojo <- mutate(jojo, Speed)
```

```{r}
#Adding the hunting pressure
#Hunting pressure was calculated based on the official hunting periods of the canton Fribourg. Some of the hunting periods are overlaping depending on the species that can be hunted. Hunting pressure 0 is no hunting, 1 is 1 species hunted, 2 is 2 species hunted, 3 is 3 species hunted. One of the hunted species is always the wild boar. The more species can be hunted, the more people are out to hunt, what means more pressure/disturbance, even if the people are not necessarily hunting wild boars.

jojo <- mutate(jojo, Daytime = case_when(Timelag < 65 ~ "Night", Timelag > 300 ~ "Day"))
jojo <- mutate(jojo, Huntpressure = (case_when(Date >= "2019-09-01" & Date <= "2019-09-15" ~ "1", Date >= "2019-09-16" & Date <= "2019-09-27" ~ "3", Date >= "2019-09-28" & Date <= "2019-10-11" ~ "2", Date >= "2019-10-12" & Date <= "2019-10-13" ~ "1", Date >= "2019-10-14" & Date <= "2019-10-25" ~ "2", Date >= "2019-10-26" & Date <= "2019-11-01" ~ "1", Date >= "2019-11-02" & Date <= "2019-11-15" ~ "2", Date >= "2019-11-16" & Date <= "2019-12-31" ~ "1", Date >= "2020-01-01" & Date <= "2020-08-31" ~ "0", Date >= "2020-09-01" & Date <= "2020-09-15" ~ "1", Date >= "2020-09-16" & Date <= "2020-09-20" ~ "2", Date >= "2020-09-21" & Date <= "2020-10-02" ~ "3", Date >= "2020-10-03" & Date <= "2020-10-11" ~ "2", Date >= "2020-10-12" & Date <= "2020-10-18" ~ "1", Date >= "2020-10-19" & Date <= "2020-10-31" ~ "2", Date >= "2020-11-01" & Date <= "2020-11-06" ~ "1", Date >= "2020-11-07" & Date <= "2020-11-21" ~ "2", Date >= "2020-11-22" & Date <= "2020-12-31" ~ "2", Date >= "2021-01-01" & Date <= "2021-08-31" ~ "0")))
jojo <- mutate(jojo, Hunting = case_when(Huntpressure == 1 ~ "yes", Huntpressure == 2 ~ "yes", Huntpressure == 3 ~ "yes", Huntpressure == 0 ~ "no"))
View(jojo)
```

```{r}
#Global movement analysis, 2019-2021
PLOT1 <- ggplot(jojo, aes(X, Y)) + geom_point(aes(color = "orange"), show.legend = FALSE) 
PLOT1
jojo_sf <- st_as_sf(jojo, coords = c("X", "Y"), crs = 2056)
jojo_smry <- summarise(jojo_sf)
jojo_mcp <- st_convex_hull(jojo_smry)
df_hull2 <- jojo %>% select(X,Y)
c.hull2 <- chull(df_hull2)  #Calculates convex hull#
c.hull3 <- c(c.hull2, c.hull2[1])
chull.coords <- df_hull2[c.hull3 ,]
chull.poly <- Polygon(chull.coords, hole=F)  #From the package sp
chull.area <- chull.poly@area
chull.area #The home range of jojo was 158968020 m2 (2019-2021)

regio_map <- terra::rast("regio_map.tif")
plot(regio_map)
map1 <- tm_shape(regio_map) + tm_rgb() + tm_shape(jojo_mcp) + tm_polygons(col = "orange",alpha = 0.3,border.col = "red") + tm_layout(main.title = "Global distribution map")
map1
```

```{r}
#isolating 2020 -> depending on the analysis, I will only use 2020 as it is the only entire year I have. 

jojo2020 <- filter(jojo, Year == 2020)
View(jojo2020)

ggplot(jojo2020) + geom_point(mapping = aes(X, Y, colour = Month))
```

```{r}
#Analyse of elevation, 2020

ggplot(data = jojo2020) +geom_boxplot(mapping = aes(x = Month, y = Altitude), color = "indianred4") +scale_y_continuous(limits = c(400, 2000)) + ggtitle("Elevation distribution per Month in 2020") + xlab("Month") + ylab("Elevation in meters") + scale_x_discrete(limits=c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))+ theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Density-map was done with ArcGis-Pro.

```{r}
#Analyzing path, 2020

ggplot(jojo2020, aes(X, Y)) + geom_path(show.legend = FALSE, color = "indianred4") + facet_wrap (~ Month)
```

```{r}
#Analyzing path in 2020 in a more funny way 

p <- ggplot(jojo2020, aes(X, Y)) + geom_path(show.legend = FALSE, mapping = aes(color = "indianred4")) + transition_time(Date) + labs(title = "Date : {frame_time}")
path2020 <- animate(p, duration = 120, render = gifski_renderer())
anim_save("jojo_path2020.gif", path2020)
```

```{r}
#Land cover analysis : what is where and where was the wild boar, 2020

jojo_sf <- st_as_sf(jojo2020, coords = c("X", "Y"), crs = 2056)
View(jojo_sf)

land_cover <- read_sf("land_cover.gpkg")

head(land_cover)

summary(land_cover)

land_cover <- mutate (land_cover, Landcover = as.factor(case_when(HAUPTKATEGORIE_DE == "Streueflächen" ~ "Litter surfaces", HAUPTKATEGORIE_DE == "Hecken-, Feld- und Ufergehölze" ~ "Hedges, fields and riverbank woods", HAUPTKATEGORIE_DE == "Baum, überlagernd Fläche" ~ "Tree, overlaying areas", HAUPTKATEGORIE_DE == "Dauerweiden" ~ "Permanent pastures", HAUPTKATEGORIE_DE == "Dauerwiesen" ~ "Permanent meadows", HAUPTKATEGORIE_DE == "Sömmerungsfläche" ~ "Summer pastures", HAUPTKATEGORIE_DE == "Wald" ~ "Forests", HAUPTKATEGORIE_DE == "Ackerfläche" ~"Cropland", HAUPTKATEGORIE_DE == "Flächen ausserhalb der LN" ~ "Areas outside LN", HAUPTKATEGORIE_DE == "Übrige Flächen innerhalb der LN" ~ "Other areas inside LN")))

land_cover <- mutate (land_cover, Maincover = as.factor(case_when(HAUPTKATEGORIE_DE == "Streueflächen" ~ "Grassland areas", HAUPTKATEGORIE_DE == "Hecken-, Feld- und Ufergehölze" ~ "Hedges, field and riverbank woods", HAUPTKATEGORIE_DE == "Baum, überlagernd Fläche" ~ "Grassland areas", HAUPTKATEGORIE_DE == "Dauerweiden" ~ "Grassland areas", HAUPTKATEGORIE_DE == "Dauerwiesen" ~ "Grassland areas", HAUPTKATEGORIE_DE == "Sömmerungsfläche" ~ "Grassland areas", HAUPTKATEGORIE_DE == "Wald" ~ "Forest", HAUPTKATEGORIE_DE == "Ackerfläche" ~"Grassland areas", HAUPTKATEGORIE_DE == "Flächen ausserhalb der LN" ~ "Grassland areas", HAUPTKATEGORIE_DE == "Übrige Flächen innerhalb der LN" ~ "Grassland areas")))

View(land_cover)

unique(land_cover$Landcover)

ggplot(land_cover) + geom_sf(aes(fill = Landcover)) + scale_fill_brewer(palette = "Paired")

ggplot(land_cover) + geom_sf(aes(fill = Landcover)) + scale_fill_brewer(palette = "Paired") + geom_sf(data=jojo_sf, color = "darkorange", show.legend = FALSE)

ggplot(land_cover) + geom_sf(aes(fill = Maincover)) + scale_fill_brewer(palette = "YlGn")

ggplot(land_cover) + geom_sf(aes(fill = Maincover)) + scale_fill_brewer(palette = "YlGn") + geom_sf(data=jojo_sf, color = "darkorange", show.legend = FALSE)
```

```{r}
#Land cover use, 2020

jojo_join <- st_join(jojo_sf, land_cover)

View(jojo_join)



#Main cover use per month

jojo_maincover <- jojo_join %>% st_set_geometry(NULL) %>% mutate(Month, Maincover) %>% group_by(Month, Maincover) %>% count() %>% ungroup %>% group_by(Month) %>%  mutate(Percentage = n/sum(n)) %>% ungroup() %>% mutate(Maincover = fct_reorder(Maincover, n, sum, desc = TRUE))

View(jojo_maincover)

ggplot(na.omit(jojo_maincover), aes(Month, Percentage, fill = Maincover)) + geom_col(width = 0.3) + theme_gray() + labs(title = "Use of land cover per Month", subtitle = "Only showing the most common categories") + scale_x_discrete(limits=c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")) + geom_bar(aes(Month, Percentage, fill= Maincover), colour="black", stat="identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + scale_fill_brewer(palette = "YlGn")

aggregate(Percentage ~ Maincover, FUN=mean, data = jojo_maincover) # 50.5% Forest, 35.7% Grassland, 0,3% Hedges
1-0.505-0.356-0.003 #13.6% NA

#Detailed cover use per month

jojo_landcover <- jojo_join %>% st_set_geometry(NULL) %>% mutate(Month, Landcover) %>% group_by(Month, Landcover) %>% count() %>% ungroup %>% group_by(Month) %>%  mutate(Percentage = n/sum(n)) %>% ungroup() %>% mutate (Landcover = fct_reorder(Landcover, n, sum, desc = TRUE))

View(jojo_landcover)

ggplot(na.omit(jojo_landcover), aes(Month, Percentage, fill = Landcover)) + geom_col(width = 0.3) + theme_gray() + labs(title = "Use of land cover per Month") + scale_x_discrete(limits=c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")) + geom_bar(aes(Month, Percentage, fill= Landcover), colour="black", stat="identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + scale_fill_brewer(palette = "YlGn")

aggregate(Percentage ~ Landcover, FUN=mean, data = jojo_landcover) 
# 50.5% Forest, 23.7% Summer pastures, 7.7% Permanent meadows, 4.1% Permanent pastures, 0.4% Tree, overlaying areas, 0.3% Hedges, 0.2% Litter surfaces
1-0.505-0.237-0.076-0.041-0.004-0.003-0.002 # 13.2% NA
```

```{r}
#Main land cover use depending on day time and month, 2020

jojo_mc_daytime <- jojo_join %>% st_set_geometry(NULL) %>% mutate(Month, Daytime, Maincover) %>% group_by(Month,Daytime, Maincover) %>% count() %>% ungroup %>% group_by(Month, Daytime) %>%  mutate(Percentage = n/sum(n)) %>% ungroup() %>% mutate(Maincover = fct_reorder(Maincover, n, sum, desc = TRUE))

View(jojo_mc_daytime)

ggplot(na.omit(jojo_mc_daytime), aes(Daytime, Percentage, fill = Maincover)) + geom_col(width = 0.3) + facet_wrap (~ Month) + geom_bar(aes(Daytime, Percentage, fill= Maincover), colour="black", stat="identity") + scale_fill_brewer(palette = "YlGn")
```

```{r}
#Main land cover use depending on hunting, 2020

jojo_mc_hunting <- jojo_join %>% st_set_geometry(NULL) %>% mutate(Hunting, Maincover) %>% group_by(Hunting, Maincover) %>% count() %>% ungroup %>% group_by(Hunting) %>%  mutate(Percentage = n/sum(n)) %>% ungroup() %>% mutate(Maincover = fct_reorder(Maincover, n, sum, desc = TRUE))

View(jojo_mc_hunting)

ggplot(na.omit(jojo_mc_hunting), aes(Hunting, Percentage, fill = Maincover)) + geom_col(width = 0.3) + geom_bar(aes(Hunting, Percentage, fill= Maincover), colour="black", stat="identity") + scale_fill_brewer(palette = "YlGn")
```

```{r}
#Analyse of activity patterns, based on the speed (in meters/minute), 2019-2021

summary(jojo)
#All websites i found say that maximal speed for a wildboar is about 40 km/h. In our case, the max speed is 55 m/min = 3.3 km/h. Therefore, there is no correction of the data. We also don't have any negative values

#Speed depending on daytime and month

jojo_day <- subset(jojo, Daytime == "Day", select=c(X, Y, Date, Time, Timelag, Steplength, Speed, Huntpressure, Hunting))
jojo_night <- subset(jojo, Daytime == "Night", select=c(X, Y, Date, Time, Timelag, Steplength, Speed, Huntpressure, Hunting))
summary(jojo_day) #mean speed = 0.64 m/min
summary(jojo_night) #mean speed = 5.04 m/min 

ggplot(na.omit(jojo)) + geom_boxplot(mapping = aes(Daytime, Speed), color = "indianred4") + scale_y_continuous(limits = c(0, 30)) + ggtitle("Speed depending on Daytime") + xlab("Daytime") + ylab("Speed in m/min")


ggplot(na.omit(jojo)) +geom_boxplot(mapping = aes(x = Daytime, y = Speed), color = "indianred4") +scale_y_continuous(limits = c(0, 30)) + ggtitle("Speed depending on Daytime per Month") + xlab("Month") + ylab("Speed in m/min") + facet_wrap(~Month)

#Speed depending on hunting pressure

ggplot(data = jojo) + geom_boxplot(mapping = aes(x = Huntpressure, y = Speed), color = "indianred4") + scale_y_continuous(limits = c(0,30)) + ggtitle("Speed depending on Huntingpressure") + xlab("Hunting pressure") + ylab("Speed in m/min") + scale_x_discrete(limits=c("0", "1", "2", "3"))

aggregate(Speed ~ Huntpressure, FUN=mean, data = jojo)

```

```{r}
#Speed depending on land cover use, 2020

View(jojo_join)

ggplot(na.omit(jojo_join)) + geom_boxplot(mapping = aes(x = Landcover, y = Speed), color = "indianred4") + scale_y_continuous(limits = c(0,30)) + scale_x_discrete(limits = c("Forests", "Permanent meadows", "Permanent pastures", "Summer pastures", "Tree, overlaying areas", "Hedges, fields and riverbank woods")) + ggtitle("Speed depending on Landcover") + xlab("Landcover") + ylab("Speed in m/min")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))

aggregate(Speed ~ Landcover, FUN=mean, data = jojo_join)
```
